(()=>{var e={4792:(e,t,r)=>{"use strict";var n=r(7294),o=r(3935),a=r(4751),i=r(3727),l=r(9862),c=r(2001),u=r(5834),s=r(3457),f=(r(489),r(8304),r(2318)),m=r(1120),d=r(7623);const p=(0,m.Z)((function(e){return(0,d.Z)({root:{marginTop:e.spacing(10),textAlign:"center"}})}));var g=function(){var e=p();return n.createElement("div",{className:e.root},n.createElement(f.Z,{variant:"h4",component:"h2"},"Something went wrong. Please refresh x_X"))};function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(i,e);var t,r,o,a=b(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={hasError:!1},t}return t=i,o=[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}],(r=[{key:"componentDidCatch",value:function(e,t){console.error(e,t)}},{key:"render",value:function(){var e=this.props.children;return this.state.hasError?n.createElement(g,null):e}}])&&h(t.prototype,r),o&&h(t,o),i}(n.Component),C=r(5258),k=r(1749),x=r(7812),Z=r(9570),M=r(8358),O=r(6447),T=r(847),P=r(2516),j=r(4130);r(9070);function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const N=(0,m.Z)((function(e){return(0,d.Z)({root:{backgroundColor:e.palette.background.paper},title:{flexGrow:1,fontSize:"1.5rem",lineHeight:1.6},titleLink:{textDecoration:"none","&:hover":{color:e.palette.text.secondary}},colorControl:A({display:"none",marginLeft:10,marginRight:15,fontSize:"1rem"},e.breakpoints.up("md"),{display:"block"}),mobileColorControl:A({},e.breakpoints.up("md"),{display:"none"})})}));var I=function(e){var t=e.colorMode,r=e.toggleColorMode,o=N(),a=t===j.ColorMode.Dark,l=a?"light":"dark";return n.createElement(C.Z,{position:"static",color:"default",elevation:2,className:o.root},n.createElement(M.Z,null,n.createElement(f.Z,{variant:"h1",noWrap:!0,className:o.title},n.createElement(O.ZP,{title:"Home"},n.createElement(i.rU,{to:"/",className:o.titleLink},"chessplayer"))),n.createElement(f.Z,{component:"div",noWrap:!0,className:o.colorControl},n.createElement(k.Z,{component:"label",container:!0,alignItems:"center",spacing:1},n.createElement(k.Z,{item:!0},"Light"),n.createElement(k.Z,{item:!0},n.createElement(O.ZP,{title:"Toggle theme"},n.createElement(Z.Z,{checked:a,color:"default",onChange:r}))),n.createElement(k.Z,{item:!0},"Dark"))),n.createElement("div",{className:o.mobileColorControl},n.createElement(O.ZP,{title:"Use ".concat(l," mode")},n.createElement(x.Z,{"aria-label":"Use ".concat(l," mode"),color:"inherit",onClick:r},n.createElement(T.Z,null)))),n.createElement(O.ZP,{title:"Github repository"},n.createElement(x.Z,{"aria-label":"GitHub repository",color:"inherit",component:"a",edge:"end",href:"https://github.com/findawayer/chessplayer",rel:"external noopener noreferrer"},n.createElement(P.Z,null)))))};const z=(0,m.Z)({root:{height:"100%",display:"flex",flexDirection:"column"},body:{overflow:"auto",flexGrow:1}});const L=function(e){var t=e.children,r=e.colorMode,o=e.toggleColorMode,a=z();return n.createElement("div",{className:a.root},n.createElement(I,{colorMode:r,toggleColorMode:o}),n.createElement("div",{className:a.body},t))};var R=r(5977),F=r(3832),D=r(5534),G=r.n(D),q=r(282),B=r(8463),U=r(1907),W=r(9912),_=r(553),$=r(4436),H=r(6019),Q=r(74),K=r(7162),V=r(4845),Y=(r(2222),r(561),r(9601),r(7407)),J=(r(9554),r(6992),r(1532),r(1539),r(8783),r(4747),r(3948),r(2526),r(1817),r(2165),r(2772),r(4174)),X=r.n(J),ee="87654321",te="abcdefgh",re=ee.length,ne=te.length,oe=re*ne,ae=100/ee.length,ie=.5;function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e){if("object"===le(e)){var t=ee.charAt(e.y);return te.charAt(e.x)+t}return e}function ue(e){return"string"==typeof e?{x:te.indexOf(e[0]),y:ee.indexOf(e[1])}:e}var se=function(e){var t={},r={},n=new Map;return e.forEach((function(e,o){e.forEach((function(e,a){if(e){var i=e.color,l=e.type,c="".concat(i).concat(l),u=n.has(c)?n.get(c)+1:0;n.set(c,u);var s="".concat(c).concat(u),f=ce({x:a,y:o});t[s]={id:s,color:i,variant:l},r[f]=s}}))})),{byId:t,positions:r}};function fe(e){return"b"===e?"w":"b"}function me(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var de=function(e){return{name:e}};function pe(e){var t=e.color,r=e.variant;return"piece-".concat(t).concat(r)}function ge(e){return"square-".concat(ce(e))}r(1249),r(2087);var ve=r(5578),he=r.n(ve);var ye,be;j.ColorMode.Light;function Ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e){e.SetDuration="setDuration",e.SetIncrement="setIncrement",e.SetPlayerColor="setPlayerColor",e.SetPlayerColorByOption="setPlayerColor",e.SetEngineLevel="setEngineLevel",e.SetPieces="setPieces",e.MovePiece="movePiece",e.PlayMove="playMove",e.UndoMove="undoMove",e.ClearMoves="clearMoves",e.SetPlayers="setPlayers",e.SetActive="setActive",e.Checkmate="checkmate",e.Resign="resign",e.Timeout="timeout",e.Stalemate="stalemate",e.NotEnoughMaterial="notEnoughMaterial",e.Repetition="repetition",e.ResetGame="resetGame",e.FlipBoard="flipBoard"}(be||(be={}));var we=(0,Y.oM)({name:"chess",initialState:{duration:3e5,increment:3e3,turn:"w",pieces:{byId:{},positions:{}},moves:[],players:{w:{name:"",score:0},b:{name:"",score:0}},playerColor:"w",engineLevel:2,isFlipped:!1,isFrozen:!1,gameOver:!1},reducers:(ye={},Ee(ye,be.SetDuration,(function(e,t){e.duration=t.payload})),Ee(ye,be.SetIncrement,(function(e,t){e.increment=t.payload})),Ee(ye,be.SetPlayerColor,(function(e,t){e.playerColor=t.payload})),Ee(ye,be.SetEngineLevel,(function(e,t){e.engineLevel=t.payload})),Ee(ye,be.SetPieces,(function(e,t){e.pieces=se(t.payload.board)})),Ee(ye,be.MovePiece,(function(e,t){var r=t.payload,n=r.from,o=r.to,a=e.pieces.positions[n];e.pieces.positions[o]=a,delete e.pieces.positions[n]})),Ee(ye,be.PlayMove,(function(e,t){var r=t.payload,n=r.from,o=r.to,a=r.promotion,i=r.san,l=e.pieces.positions[n];if(l&&(e.pieces.positions[o]=l,delete e.pieces.positions[n]),a){var c=e.pieces.positions[r.to];e.pieces.byId[c].variant=a}if(function(e){return/[kq]/.test(e.flags)}(t.payload)){var u=(ue(o).x+1)/ne<=.5,s=o[1],f="".concat(u?"a":"h").concat(s),m=e.pieces.positions[f],d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=ue(e),o=n.x,a=n.y;return ce({x:o+t,y:a+r})}(o,u?1:-1);e.pieces.positions[d]=m,delete e.pieces.positions[f]}var p=Math.floor(e.moves.length/2)+1,g=e.moves.length+1;e.moves.push({fullmove:p,halfmove:g,from:n,to:o,san:i}),e.turn=fe(e.turn)})),Ee(ye,be.UndoMove,(function(e,t){var r=t.payload.length||1,n=-1*r,o=e.moves.length-n;e.moves.splice(n,o),r%2&&(e.turn=fe(e.turn)),e.pieces=se(t.payload.board)})),Ee(ye,be.ClearMoves,(function(e){e.moves=[],e.turn="w"})),Ee(ye,be.SetPlayers,(function(e,t){var r=t.payload;Object.assign(e.players.w,r.w),Object.assign(e.players.b,r.b)})),Ee(ye,be.Checkmate,(function(e,t){var r=t.payload.winner;e.gameOver={type:j.ChessGameOverType.Checkmate,winner:r},e.players[r].score+=1,e.isFrozen=!0})),Ee(ye,be.Timeout,(function(e,t){var r=t.payload.winner;e.gameOver={type:j.ChessGameOverType.Timeout,winner:r},e.players[r].score+=1,e.isFrozen=!0})),Ee(ye,be.Resign,(function(e){if(!e.gameOver&&e.playerColor){var t=fe(e.playerColor);e.gameOver={type:j.ChessGameOverType.Resignation,winner:t},e.players[t].score+=1,e.isFrozen=!0}})),Ee(ye,be.Stalemate,(function(e){e.gameOver={type:j.ChessGameOverType.Stalemate,winner:null},e.players.w.score+=ie,e.players.b.score+=ie,e.isFrozen=!0})),Ee(ye,be.NotEnoughMaterial,(function(e){e.gameOver={type:j.ChessGameOverType.NotEnoughMaterial,winner:null},e.players.w.score+=ie,e.players.b.score+=ie,e.isFrozen=!0})),Ee(ye,be.Repetition,(function(e){e.gameOver={type:j.ChessGameOverType.Repetition,winner:null},e.players.w.score+=ie,e.players.b.score+=ie,e.isFrozen=!0})),Ee(ye,be.ResetGame,(function(e,t){if(e.pieces=se(t.payload.board),e.moves=[],t.payload.alternate){var r=[e.players.b,e.players.w];e.players.w=r[0],e.players.b=r[1],e.playerColor&&(e.playerColor=fe(e.playerColor)),e.isFlipped=!e.isFlipped}e.gameOver=!1,e.isFrozen=!1})),Ee(ye,be.FlipBoard,(function(e){e.isFlipped=!e.isFlipped})),ye)}),Se=we.actions,Ce=we.reducer,ke=Se.setDuration,xe=Se.setIncrement,Ze=Se.setPlayerColor,Me=Se.setEngineLevel,Oe=Se.setPieces,Te=Se.movePiece,Pe=Se.playMove,je=Se.undoMove,Ae=(Se.clearMoves,Se.setPlayers),Ne=Se.checkmate,Ie=Se.resign,ze=Se.timeout,Le=Se.stalemate,Re=Se.notEnoughMaterial,Fe=Se.repetition,De=Se.resetGame,Ge=Se.flipBoard;const qe=(0,m.Z)((function(e){return(0,d.Z)({root:{padding:e.spacing(4,6),textAlign:"center",boxShadow:e.shadows[2],transition:"box-shadow ".concat(e.transitions.duration.shortest," ").concat(e.transitions.easing.easeOut),"&:hover":{boxShadow:e.shadows[8]}},header:{marginBottom:e.spacing(4)},title:{marginBottom:e.spacing(3),fontSize:e.typography.h3.fontSize},formRow:{display:"block",marginBottom:e.spacing(3)},formLabel:{color:e.palette.text.secondary,fontSize:e.typography.body1.fontSize},formRadioGroup:{display:"flex",justifyContent:"center"}})}));var Be=function(e){var t=e.duration,r=e.engineLevel,o=e.increment,l=e.playerColor,c=(0,a.I0)(),u=qe(),s=(0,n.useMemo)((function(){return t/1e3/60}),[t]),m=(0,n.useMemo)((function(){return o/1e3}),[o]);return n.createElement(B.Z,{elevation:2,className:u.root},n.createElement(W.Z,null,n.createElement("header",{className:u.header},n.createElement(f.Z,{variant:"h5",component:"h2",className:u.title},"Start a game")),n.createElement($.Z,{component:"fieldset",className:u.formRow},n.createElement(H.Z,{id:"duration",className:u.formLabel},"Time per side: ",s," min."),n.createElement(V.Z,{"aria-labelledby":"duration",max:30,min:1,name:"duration",onChange:function(e,t){return c(ke(1e3*t*60))},value:s,valueLabelDisplay:"auto"})),n.createElement($.Z,{component:"fieldset",className:u.formRow},n.createElement(H.Z,{id:"increment",className:u.formLabel},"Time gained per move: ",m," sec."),n.createElement(V.Z,{"aria-labelledby":"increment",max:10,min:0,name:"increment",onChange:function(e,t){return c(xe(1e3*t))},value:m,valueLabelDisplay:"auto"})),n.createElement($.Z,{component:"fieldset",className:u.formRow},n.createElement(H.Z,{id:"mode",className:u.formLabel},"Game mode"),n.createElement(K.Z,{"aria-label":"Game mode",className:u.formRadioGroup,defaultValue:"play",name:"mode",onChange:function(e){return c(Ze("simulate"===e.target.value?null:"w"))},row:!0},n.createElement(_.Z,{value:"play",control:n.createElement(Q.Z,{color:"primary"}),label:"Play"}),n.createElement(_.Z,{value:"simulate",control:n.createElement(Q.Z,{color:"primary"}),label:"AI simulation"}))),l&&n.createElement($.Z,{component:"fieldset",className:u.formRow},n.createElement(H.Z,{id:"playerColor",className:u.formLabel},"Play as"),n.createElement(K.Z,{"aria-label":"Your preferred piece color",className:u.formRadioGroup,defaultValue:"w",name:"playerColor",onChange:function(e){var t=e.target.value,r="random"===t?G()(["b","w"]):t;c(Ze(r))},row:!0},n.createElement(_.Z,{control:n.createElement(Q.Z,{color:"primary"}),label:"White",value:"w"}),n.createElement(_.Z,{control:n.createElement(Q.Z,{color:"primary"}),label:"Black",value:"b"}),n.createElement(_.Z,{control:n.createElement(Q.Z,{color:"primary"}),label:"Random",value:"random"}))),n.createElement($.Z,{component:"fieldset",className:u.formRow},n.createElement(H.Z,{id:"increment",className:u.formLabel},"AI strength: ",r),n.createElement(V.Z,{"aria-labelledby":"AI level",color:"primary",max:20,min:0,name:"engineSkillLevel",onChange:function(e,t){return c(Me(t))},value:r,valueLabelDisplay:"auto"}))),n.createElement(U.Z,null,n.createElement(q.Z,{color:"primary",component:i.rU,fullWidth:!0,size:"large",to:"/play",variant:"contained"},"Start")))};const Ue=function(){var e=(0,a.v9)((function(e){return{duration:e.chess.duration,engineLevel:e.chess.engineLevel,increment:e.chess.increment,playerColor:e.chess.playerColor}})),t=e.duration,r=e.engineLevel,o=e.increment,i=e.playerColor;return n.createElement(Be,{duration:t,engineLevel:r,increment:o,playerColor:i})},We=(0,m.Z)({root:{height:"100%",margin:"0 auto",display:"flex",flexFlow:"row nowrap",justifyContent:"center"}});var _e=function(){var e=We();return n.createElement(F.Z,{maxWidth:"sm",className:e.root},n.createElement(k.Z,{container:!0,justify:"center",alignItems:"center",spacing:2},n.createElement(k.Z,{item:!0,xs:1}),n.createElement(k.Z,{item:!0,xs:10},n.createElement(Ue,null)),n.createElement(k.Z,{item:!0,xs:1})))},$e=function(){return n.createElement("div",null,n.createElement("h2",null,"Not Found \ud83e\udd14"))},He=(r(9753),r(6010)),Qe=r(7835),Ke=r(589);const Ve=(0,m.Z)({piece:{padding:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"85%",border:0,appearance:"none",touchAction:"none","&::before":{content:'""',display:"block",paddingTop:"100%"},"&.piece-bk":{backgroundImage:"url(/assets/svg/BlackKing.svg)"},"&.piece-bq":{backgroundImage:"url(/assets/svg/BlackQueen.svg)"},"&.piece-br":{backgroundImage:"url(/assets/svg/BlackRook.svg)"},"&.piece-bb":{backgroundImage:"url(/assets/svg/BlackBishop.svg)"},"&.piece-bn":{backgroundImage:"url(/assets/svg/BlackKnight.svg)"},"&.piece-bp":{backgroundImage:"url(/assets/svg/BlackPawn.svg)"},"&.piece-wk":{backgroundImage:"url(/assets/svg/WhiteKing.svg)"},"&.piece-wq":{backgroundImage:"url(/assets/svg/WhiteQueen.svg)"},"&.piece-wr":{backgroundImage:"url(/assets/svg/WhiteRook.svg)"},"&.piece-wb":{backgroundImage:"url(/assets/svg/WhiteBishop.svg)"},"&.piece-wn":{backgroundImage:"url(/assets/svg/WhiteKnight.svg)"},"&.piece-wp":{backgroundImage:"url(/assets/svg/WhitePawn.svg)"}},playablePiece:{position:"absolute",width:"".concat(ae,"%"),cursor:"grab","&.is-dragging":{visibility:"hidden"}}});var Ye,Je=r(6408),Xe=(r(7327),{enableMouseEvents:!0,enableHoverOutsideTarget:!1,getDropTargetElementsAtPoint:document&&(document.elementsFromPoint||document.msElementsFromPoint)?void 0:function(e,t,r){return r.filter((function(r){var n=r.getBoundingClientRect();return e>=n.left&&e<=n.right&&t<=n.bottom&&t>=n.top}))}});function et(e,t,r){var n,o,a,i=t.getDifferenceFromInitialOffset(),l=r?-1:1,c={x:e.x+Math.round(i.x/e.size)*l,y:e.y+Math.round(i.y/e.size)*l};return n=ue(c),o=n.x,a=n.y,X()(o,0,ne)&&X()(a,0,re)?ce(c):null}function tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.PIECE="piece"}(Ye||(Ye={}));var nt=function(e){var t=e.id,r=e.color,o=e.variant,a=e.x,i=e.y,l=e.size,c=e.isFrozen,u=e.handleSelect,s=tt((0,Qe.useDrag)({item:{type:Ye.PIECE,id:t,color:r,variant:o,x:a,y:i,size:l},canDrag:!c,collect:function(e){return{isDragging:e.isDragging()}}}),3),f=s[0].isDragging,m=s[1],d=s[2],p=Ve();return(0,n.useEffect)((function(){d((0,Je.r)(),{captureDraggingState:!0})}),[]),n.createElement("div",{ref:m,className:(0,He.Z)(p.piece,p.playablePiece,pe({color:r,variant:o}),ge({x:a,y:i}),f&&"is-dragging"),"aria-label":o,onMouseDown:function(){return u({x:a,y:i})},onTouchStart:function(){return u({x:a,y:i})}})},ot=function(e){var t=e.color,r=e.variant,o=e.size,a=Ve();return n.createElement("div",{className:(0,He.Z)(a.piece,pe({color:t,variant:r})),style:{width:o}})},at=(0,n.memo)(ot);const it=(0,m.Z)({dragLayer:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:100,pointerEvents:"none"},dragObject:{cursor:"grabbing"}});function lt(e,t){if(!e||!t)return{display:"none"};var r=t.x,n=t.y;return{transform:"translate3d(".concat(r,"px, ").concat(n,"px, 0)")}}var ct=function(){var e=(0,Qe.useDragLayer)((function(e){return{item:e.getItem(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}})),t=e.item,r=e.initialOffset,o=e.currentOffset,a=e.isDragging,i=it();return a?n.createElement("div",{className:i.dragLayer},n.createElement("div",{className:i.dragObject,style:lt(r,o)},n.createElement(at,{color:t.color,variant:t.variant,size:t.size}))):null},ut=r(8913),st=r.n(ut),ft=r(3663),mt=(0,n.createContext)(ft.defaultChessBoardTheme),dt=r(8437),pt=new(r.n(dt)()),gt=(0,n.createContext)(pt);const vt=(0,m.Z)({grid:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexFlow:"row wrap"},square:{width:"".concat(ae,"%"),height:"".concat(ae,"%"),flex:"0 0 auto","&.light":{backgroundColor:function(e){return e.lightSquare}},"&.dark":{backgroundColor:function(e){return e.darkSquare}}}});var ht=function(e){var t,r=e.handleBlur,o=(0,n.useContext)(mt),a=vt(o);return n.createElement("div",{className:a.grid,onClick:r},(t=a.square,st()(oe,(function(e){var r=e%re,o=Math.floor(e/ne),a=(r+o)%2==1;return n.createElement("div",{key:"".concat(r).concat(o),className:(0,He.Z)(t,a?"dark":"light")})}))))},yt=(0,n.memo)(ht);function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Et(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wt={startTime:null,lastTime:null,elapsed:0,side:"w",w:{delta:0,deltaSeconds:0},b:{delta:0,deltaSeconds:0}},St=function(e){return 1e3*Math.floor(e/1e3)},Ct=r(7145),kt=r.n(Ct);function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ot(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ot(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Tt;!function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Ready=2]="Ready",e[e.Running=3]="Running"}(Tt||(Tt={}));r(4916),r(4723);var Pt=r(4691),jt=r.n(Pt),At=/^uciok$/,Nt=/^readyok$/,It=/^(?:(?:uci|ready)ok$|option name)/,zt=/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/,Lt=(r(5827),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stockfish.js",t=(0,n.useRef)();(0,n.useEffect)((function(){t.current=new Worker(e)}),[e]);var r=(0,n.useCallback)((function(e){t.current&&(t.current.onmessage=e)}),[]),o=(0,n.useCallback)((function(e){var r;null===(r=t.current)||void 0===r||r.postMessage(e)}),[]);return[r,o]});function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Dt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gt=function(e){var t=e.duration,r=e.increment,o=e.skillLevel,a=void 0===o?20:o,i=e.filepath,l=void 0===i?"stockfish.js":i,c=Ft(Lt(l),2),u=c[0],s=c[1],f=Ft(Lt(l),2),m=f[0],d=f[1],p=Ft((0,n.useState)(Tt.Loading),2),g=p[0],v=p[1],h=Ft((0,n.useState)(null),2),y=h[0],b=h[1],E=Ft((0,n.useState)(null),2),w=E[0],S=E[1],C=g===Tt.Ready,k=g===Tt.Running,x=(0,n.useCallback)((function(e){var t=jt()(e,0,20),r=function(e){return e<15?Math.ceil((e+1)/5):null}(t),n=function(e){return Math.round(6.35*e+1)}(t),o=function(e){return Math.round(-.5*e+10)}(t);b(r),s("setoption name Skill Level value ".concat(e)),s("setoption name Skill Level Maximum Error value ".concat(o)),s("setoption name Skill Level Probability value ".concat(n))}),[s]),Z=(0,n.useCallback)((function(e){var n=e.history,o=e.accelerate;if(!k){var a=function(e){return e.reduce((function(e,t){var r=t.from,n=t.to,o=t.promotion;return"".concat(e," ").concat(r).concat(n).concat(o||"")}),"")}(n);if(v(Tt.Running),S(null),s("position startpos moves ".concat(a)),d("position startpos moves ".concat(a)),o){var i=function(e){var t=e.depth,r=e.duration,n=e.increment,o=t?"depth ".concat(t):"";return r&&(o+=" wtime ".concat(r," winc ").concat(n," btime ").concat(r," binc ").concat(n)),o}({depth:y,duration:t,increment:r});s("go ".concat(i))}else s("go")}}),[s,d,y,t,r,k]),M=(0,n.useCallback)((function(e){var t="object"===Rt(e)?e.data:e;if(!It.test(t))if(At.test(t))v(Tt.Loaded);else if(Nt.test(t))v(Tt.Ready);else{if(zt.test(t)){var r=Ft(t.match(zt),4),n=r[1],o=r[2],a=r[3];S({from:n,to:o,promotion:a}),d("eval"),v(Tt.Ready)}console.debug("engine",t)}}),[d]),O=(0,n.useCallback)((function(e){var t="object"===Rt(e)?e.data:e;It.test(t)||console.debug("evaler",t)}),[]);return(0,n.useEffect)((function(){u(M),m(O)}),[u,m,M,O]),(0,n.useEffect)((function(){s("uci"),s("setoption name Contempt value 0"),s("setoption name Ponder value true"),s("setoption name Minimum Thinking Time value 500")}),[s]),(0,n.useEffect)((function(){x(a)}),[x,a]),(0,n.useEffect)((function(){s("isready"),s("ucinewgame")}),[s]),(0,n.useEffect)((function(){return function(){s("quit"),d("quit")}}),[s,d]),[w,Z,C,k]};function qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(r),!0).forEach((function(t){Ut(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ut(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Wt=(0,m.Z)((function(e){return(0,d.Z)({board:Bt({position:"relative",width:"80vh",height:"80vh",minWidth:500,minHeight:500,overflow:"hidden",borderRadius:e.shape.borderRadius,flex:"0 0 auto"},(t={},st()(ne,(function(e){t["& .file-".concat(e)]={transform:"translateX(".concat(100*e,"%)")}})),st()(re,(function(e){t["& .rank-".concat(e)]={transform:"translateY(".concat(100*e,"%)")}})),st()(ne,(function(e){st()(re,(function(r){var n=ne-1-e,o=re-1-r;t["& .".concat(ge({x:e,y:r}))]={transform:"translate(".concat(100*e,"%, ").concat(100*r,"%)")},t["&.is-flipped .".concat(ge({x:e,y:r}))]={transform:"translate(".concat(100*n,"%, ").concat(100*o,"%)")}}))})),t))});var t}));var _t=r(5161),$t=r.n(_t),Ht=r(5889);const Qt=(0,m.Z)((function(e){return(0,d.Z)({guide:{position:"absolute",width:"".concat(ae,"%"),height:"".concat(ae,"%"),backgroundColor:function(t){var r=t.variant;return/(?:active|recent)/.test(r)?(0,Ht.U1)(e.chessSquare.highlight,.5):"transparent"},boxShadow:function(t){return"hover"===t.variant?"inset 0 0 0 4px ".concat((0,Ht.U1)(e.chessSquare.hover,.5)):"none"}}})}));var Kt=function(e){var t=e.variant,r=e.square,o=Qt({variant:t});return n.createElement("div",{className:(0,He.Z)(o.guide,ge(r))})},Vt=(0,n.memo)(Kt);const Yt=(0,m.Z)({legalSquare:{position:"absolute",width:"".concat(ae,"%"),height:"".concat(ae,"%"),padding:"4%",boxSizing:"border-box",backgroundColor:function(e){return e.isCapture?"transparent":"rgba(0 0 0 / 20%)"},border:function(e){return e.isCapture?"8px solid rgba(0 0 0 / 20%)":0},backgroundClip:"content-box",borderRadius:"50%",opacity:function(e){return e.showLegalMoves?1:0}}});var Jt=function(e){var t=e.flags,r=e.square,o=e.showLegalMoves,a=e.handleSelect,i=-1!==t.indexOf("c"),l=Yt({isCapture:i,showLegalMoves:o});return n.createElement("div",{className:(0,He.Z)(l.legalSquare,ge(r)),onClick:function(){return a(r)}})};const Xt=(0,m.Z)({promotion:{position:"absolute",top:0,right:0,bottom:0,left:0,zIndex:10},backdrop:{position:"absolute",top:0,right:0,bottom:0,left:0},pieceWrapper:{position:"absolute",top:0,left:0,width:"".concat(ae,"%"),height:"".concat(4*ae,"%"),display:"flex",flexFlow:"column",backgroundColor:"#fff",boxShadow:"0 3px 10px rgba(0 0 0 / 50%)","&.bottom":{top:"auto",bottom:0,flexFlow:"column-reverse"}},piece:{position:"static",width:"100%",backgroundColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:"rgba(0 0 0 / 8%)"}}});var er=function(e){var t=e.color,r=e.square,o=e.abortPromotion,a=e.selectPromotion,i=(0,n.useMemo)((function(){return ue(r)}),[r]),l=i.x,c=i.y,u=Xt(),s=Ve().piece,m=0===c?"top":"bottom";return n.createElement("div",{className:u.promotion},n.createElement("div",{className:u.backdrop,role:"presentation",onClick:function(){return o()}}),n.createElement("div",{className:(0,He.Z)(u.pieceWrapper,m,"file-".concat(l))},["q","n","r","b"].map((function(e){return n.createElement("button",{key:e,type:"button",className:(0,He.Z)(s,u.piece,pe({color:t,variant:e})),onClick:function(){return a(e)}},n.createElement(f.Z,{variant:"srOnly"},function(e){switch(e){case"k":return"king";case"q":return"queen";case"r":return"rook";case"n":return"knight";case"b":return"bishop";case"p":return"pawn";default:throw new Error("Unhandled piece variant: ".concat(e,"."))}}(e)))}))))};function tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var nr=(0,Ke.Z)((function(e){var t,r,o=e.pieces,i=e.recentMovePath,l=e.isFlipped,c=e.isFrozen,u=e.autoPromoteToQueen,s=e.highlightMoves,f=e.showLegalMoves,m=e.width,d=(0,n.useContext)(gt),p=(0,a.I0)(),g=(0,n.useMemo)((function(){return m/ne}),[m]),v=tr(function(){var e=xt((0,n.useState)({active:null,hover:null,legal:[]}),2),t=e[0],r=e[1],o=(0,n.useCallback)((function(e,t){r((function(r){return kt()(r,{$merge:{active:e?ce(e):null,legal:t||[],hover:null}})}))}),[]),a=(0,n.useCallback)((function(e){r((function(t){return kt()(t,{$merge:{hover:e?ce(e):null}})}))}),[]);return[t.active,t.hover,t.legal,o,a]}(),5),h=v[0],y=v[1],b=v[2],E=v[3],w=v[4],S=tr(function(){var e=Mt((0,n.useState)(null),2),t=e[0],r=e[1],o=(0,n.useCallback)((function(e){var t=e.color,n=e.from,o=e.to;r({color:t,from:ce(n),to:ce(o)})}),[]),a=(0,n.useCallback)((function(e){t&&r(kt()(t,{$merge:{variant:e}}))}),[t]),i=(0,n.useCallback)((function(){r(null)}),[]);return(0,n.useEffect)((function(){return function(){return r(null)}}),[]),[t,o,a,i]}(),4),C=S[0],k=S[1],x=S[2],Z=S[3],M=Wt(),O=(0,n.useCallback)((function(e){if(!c){var t=function(e,t){var r=e.moves({square:ce(t),verbose:!0}).map((function(e){return{square:e.to,flags:e.flags}}));return he()(r,"square")}(d,e);E(e,t)}}),[c,E,d]),T=(0,n.useCallback)((function(e){var t;if(!c&&h)if(t=e,ce(h)===ce(t))w(null);else{var r=o.positions[h],n=o.byId[r],a="p"===n.variant&&function(e){var t=ue(e).y;return 0===t||t===re-1}(e),i=h,l=ce(e);if(a&&!u)p(Te({from:i,to:l})),k({color:n.color,from:i,to:l});else{var s=d.move({from:i,to:l,promotion:a?"q":void 0});s&&p(Pe(s))}E(null)}}),[h,u,p,c,o,k,E,w,d]),P=(0,n.useCallback)((function(){return E(null)}),[E]),j=tr((0,Qe.useDrop)({accept:Ye.PIECE,hover:function(e,t){var r=et(e,t,l);w(r)},drop:function(e,t){var r=et(e,t,l);T(r)}}),2)[1];return(0,n.useEffect)((function(){if(C&&C.variant){var e=d.move({from:C.from,to:C.to,promotion:C.variant});e&&p(Pe(e))}}),[p,C,d]),n.createElement(n.Fragment,null,n.createElement("div",{ref:j,className:(0,He.Z)(M.board,l&&"is-flipped")},n.createElement(yt,{handleBlur:P}),s&&((r=i)?r.map((function(e){return n.createElement(Vt,{key:e,variant:"recent",square:e})})):null),s&&((t=h)?n.createElement(Vt,{variant:"active",square:t}):null),function(e){return e?n.createElement(Vt,{variant:"hover",square:e}):null}(y),function(e,t){var r=e.byId,o=e.positions,a=t.size,i=t.isFrozen,l=t.handleSelect;return $t()(o,(function(e,t){var o=r[e],c=o.color,u=o.variant,s=ue(t),f=s.x,m=s.y;return n.createElement(nt,{key:e,id:e,color:c,variant:u,x:f,y:m,size:a,isFrozen:i,handleSelect:l})}))}(o,{size:g,isFrozen:c,handleSelect:O}),function(e,t){var r=t.showLegalMoves,o=t.handleSelect;return e.map((function(e){var t=e.square,a=e.flags;return n.createElement(Jt,{key:t,square:t,flags:a,showLegalMoves:r,handleSelect:o})}))}(b,{showLegalMoves:f,handleSelect:T}),function(e,t){var r=t.abortPromotion,o=t.selectPromotion;return e&&!e.variant?n.createElement(er,{color:e.color,square:e.to,abortPromotion:r,selectPromotion:o}):null}(C,{abortPromotion:Z,selectPromotion:x})),n.createElement(ct,null))})),or=r(8623),ar=r(9525),ir=r(6083);const lr=(0,m.Z)((function(e){return(0,d.Z)({root:{textAlign:"center"},header:{padding:e.spacing(4,4,2)},title:{marginBottom:e.spacing(1),textTransform:"capitalize"},description:{margin:0},content:{minWidth:300,padding:e.spacing(2,4,4),textAlign:"center"}})}));function cr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ur(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ur(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sr=function(e,t){return e?t?"You ".concat(e===t?"win!!":"lose\u2026"):"".concat(function(e){switch(e){case"w":return"white";case"b":return"black";default:throw new Error("Unhandled piece color: ".concat(e,"."))}}(e)," wins!!"):"Draw"},fr=function(e){var t=e.gameOver,r=e.playerColor,o=e.rematch,a=cr((0,n.useState)(!1),2),i=a[0],l=a[1],c=lr();return(0,n.useEffect)((function(){l(!!t)}),[t]),n.createElement(or.Z,{open:i,onClose:function(){return l(!1)},className:c.root,"aria-labelledby":"chessGameOverDialogTitle","aria-describedby":"chessGameOverDialogDescription"},n.createElement(ir.Z,{disableTypography:!0,className:c.header},n.createElement(f.Z,{variant:"h4",component:"div",id:"chessGameOverDialogTitle",className:c.title,"aria-level":1},t?sr(t.winner,r):""),n.createElement(f.Z,{color:"textSecondary",component:"p",id:"chessGameOverDialogDescription",className:c.description},t?function(e){switch(e.type){case j.ChessGameOverType.Checkmate:return"by checkmate";case j.ChessGameOverType.Resignation:return"by resignation";case j.ChessGameOverType.Timeout:return"on time";case j.ChessGameOverType.Stalemate:return"by stalemate";case j.ChessGameOverType.Repetition:return"by threefold repetition";case j.ChessGameOverType.NotEnoughMaterial:return"Neither player has enough materials for checkmate.";default:return""}}(t):"")),n.createElement(ar.Z,{className:c.content},n.createElement(q.Z,{variant:"contained",color:"primary",size:"medium",onClick:function(){return o(!0)}},"Rematch")))},mr=(r(8309),r(6977),r(3258)),dr=r.n(mr),pr=r(7748);const gr=(0,m.Z)((function(e){return(0,d.Z)({root:{padding:"12px 20px",backgroundColor:e.palette.background.paper,cursor:"default",userSelect:"none"},player:{display:"flex",alignItems:"center"},score:{width:"2em",marginRight:10,color:e.palette.text.secondary},name:{flexGrow:1,fontStyle:"italic"},timer:{width:"4em",color:e.palette.text.secondary,backgroundColor:e.palette.background.default,lineHeight:"1.8em",textAlign:"center"}})}));var vr=function(e){var t=e.player,r=e.time,o=gr(),a=dr()(r,{secondsDecimalDigits:0,colonNotation:!0});return n.createElement(pr.Z,{display:"flex",flexWrap:"nowrap",alignItems:"center",className:o.root},n.createElement(pr.Z,{flexGrow:1,className:o.player},n.createElement(O.ZP,{title:"Score",placement:"top-start"},n.createElement(f.Z,{variant:"h6",component:"span",className:o.score},t.score.toFixed(1))),n.createElement(O.ZP,{title:"User name",placement:"top-start"},n.createElement(f.Z,{variant:"h6",component:"strong",className:o.name},t.name))),n.createElement(pr.Z,{className:o.timer},n.createElement(O.ZP,{title:"Remaining time",placement:"top"},n.createElement(f.Z,{variant:"h6",component:"span"},a))))};function hr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const br=function(){var e=(0,n.useContext)(gt),t=(0,a.v9)((function(e){return e.chess})),r=t.duration,o=t.engineLevel,i=t.gameOver,l=t.increment,c=t.isFlipped,u=t.isFrozen,s=t.moves,f=t.playerColor,m=t.pieces,d=t.players,p=t.turn,g=(0,a.v9)((function(e){return e.preferences})),v=g.autoPromoteToQueen,h=g.boardColor,y=g.highlightMoves,b=g.showLegalMoves,E=(0,a.I0)(),w=function(e){var t=e.duration,r=e.increment,o=(0,n.useRef)(wt),a=(0,n.useRef)(),i=(0,n.useRef)(),l=bt((0,n.useState)({w:t,b:t}),2),c=l[0],u=l[1],s=(0,n.useCallback)((function(){a.current||(a.current=window.requestAnimationFrame(i.current))}),[]),f=(0,n.useCallback)((function(){a.current&&window.cancelAnimationFrame(a.current)}),[]),m=(0,n.useCallback)((function(e){var t=o.current,n=t.side;e!==n&&(t.elapsed<=r&&(t[n].delta-=r),t.side=e,t.startTime=null)}),[r]),d=(0,n.useCallback)((function(){a.current&&(window.cancelAnimationFrame(a.current),a.current=void 0),o.current=wt,u({w:t,b:t})}),[t]);return(0,n.useLayoutEffect)((function(){i.current=function(e){var r=o.current;null===r.startTime?r.startTime=e:r.elapsed=e-r.startTime,null!==r.lastTime&&(r[r.side].delta+=e-r.lastTime);var n=St(r.w.delta),l=St(r.b.delta);n===r.w.deltaSeconds&&l===r.b.deltaSeconds||(u({w:Math.max(t-n,0),b:Math.max(t-l,0)}),r.w.deltaSeconds=n,r.b.deltaSeconds=l),r[r.side].delta<t&&(a.current=window.requestAnimationFrame(i.current)),r.lastTime=e}}),[t,r,c]),(0,n.useEffect)((function(){return function(){a.current&&window.cancelAnimationFrame(a.current)}}),[]),{time:c,startClock:s,pauseClock:f,setClockSide:m,resetClock:d}}({duration:r,increment:l}),S=w.time,C=w.startClock,k=w.pauseClock,x=w.setClockSide,Z=w.resetClock,M=hr(Gt({duration:r,increment:l,skillLevel:o,filepath:"assets/stockfish/src/stockfish.js"}),2),O=M[0],T=M[1],P=(0,n.useMemo)((function(){return(0,ft.getChessBoardTheme)(h)}),[h]),j=p===f,A=S[p]<6e4,N=c?"w":"b",I=c?"b":"w",z=(0,n.useMemo)((function(){return function(e){if(!e.length)return null;var t=e[e.length-1];return[t.from,t.to]}(s)}),[s]),L=(0,n.useCallback)((function(t){e.reset(),Z(),E(De({board:e.board(),alternate:t}))}),[E,Z,e]);return(0,n.useEffect)((function(){return function(){return L(!1)}}),[L]),(0,n.useEffect)((function(){var e=f?function(e){var t,r=e.playerColor,n=de("Me"),o=de("Stockfish"),a=r||"w",i=fe(a);return me(t={},a,n),me(t,i,o),t}({playerColor:f}):{w:de("Stockfish"),b:de("Stockfish")};E(Ae(e))}),[E,f]),(0,n.useEffect)((function(){E(Oe({board:e.board()}))}),[E,e]),(0,n.useEffect)((function(){2===s.length&&C()}),[s,C]),(0,n.useEffect)((function(){x(p)}),[x,p]),(0,n.useEffect)((function(){i&&k()}),[i,k]),(0,n.useEffect)((function(){i||(0===S.w?E(ze({winner:"b"})):0===S.b&&E(ze({winner:"w"})))}),[E,i,S]),(0,n.useEffect)((function(){!i&&e.in_checkmate()&&E(Ne({winner:fe(p)}))}),[E,i,p,e]),(0,n.useEffect)((function(){i||(e.in_stalemate()?E(Le()):e.insufficient_material()?E(Re()):e.in_threefold_repetition()&&E(Fe()))}),[E,i,p,e]),(0,n.useEffect)((function(){i||j||T({history:e.history({verbose:!0}),accelerate:A})}),[T,i,j,A,e]),(0,n.useEffect)((function(){if(O){var t=e.move(O);t&&E(Pe(t))}}),[E,O,e]),n.createElement(n.Fragment,null,n.createElement(mt.Provider,{value:P},n.createElement(vr,{player:d[N],time:S[N]}),n.createElement(nr,{pieces:m,autoPromoteToQueen:v,highlightMoves:y,showLegalMoves:b,recentMovePath:z,isFlipped:c,isFrozen:u}),n.createElement(vr,{player:d[I],time:S[I]}),n.createElement(fr,{gameOver:i,playerColor:f,rematch:L})))};var Er=r(8400),wr=r.n(Er),Sr=r(5685),Cr=r(9584),kr=r(9969),xr=r(9446);const Zr=(0,m.Z)((function(e){return(0,d.Z)({root:{padding:e.spacing(0,4)},button:{fontSize:"2rem"}})}));var Mr=function(e){var t=e.canResign,r=e.canTakeBack,o=e.flipBoard,a=e.takeBack,i=e.resign,l=e.toggleSettings,c=Zr();return n.createElement(pr.Z,{display:"flex",flexWrap:"nowrap",justifyContent:"space-between",className:c.root},n.createElement(O.ZP,{title:"Rotate board"},n.createElement(x.Z,{edge:"start",className:c.button,onClick:o},n.createElement(Sr.Z,{fontSize:"inherit"}))),r?n.createElement(O.ZP,{title:"Take back a move"},n.createElement(x.Z,{className:c.button,onClick:a},n.createElement(xr.Z,{fontSize:"inherit"}))):n.createElement(x.Z,{className:c.button,disabled:!0},n.createElement(xr.Z,{fontSize:"inherit"})),t?n.createElement(O.ZP,{title:"Resign"},n.createElement(x.Z,{className:c.button,onClick:i},n.createElement(Cr.Z,{fontSize:"inherit"}))):n.createElement(x.Z,{className:c.button,disabled:!0},n.createElement(Cr.Z,{fontSize:"inherit"})),n.createElement(O.ZP,{title:"Settings"},n.createElement(x.Z,{className:c.button,edge:"end",onClick:function(){return l(!0)}},n.createElement(kr.Z,{fontSize:"inherit"}))))},Or=r(2822),Tr=r(998);const Pr=(0,m.Z)((function(e){var t="dark"===e.palette.type?"#fff":"#000";return(0,d.Z)({root:{display:"block",maxHeight:500,marginTop:20,overflow:"auto","&::-webkit-scrollbar":{width:15},"&::-webkit-scrollbar-track":{backgroundColor:(0,Ht.U1)(t,.05)},"&::-webkit-scrollbar-thumb":{backgroundColor:(0,Ht.U1)(t,.3)},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:(0,Ht.U1)(t,.4)}},fullmove:{borderBottom:"1px solid ".concat(e.palette.divider),display:"flex",alignItems:"center","&:nth-last-child(2) span:last-child":{backgroundColor:(0,Ht.U1)("#fc0",.4)}},count:{width:50,paddingRight:"1em",color:(0,Ht.U1)(e.palette.text.secondary,.6),fontSize:"92%",textAlign:"right"},halfmove:{display:"block",width:"calc(50% - 25px)",color:"inherit",padding:e.spacing(0,2),boxSizing:"border-box",textAlign:"left",textTransform:"none"}})}));var jr=function(e){var t=e.moveList,r=(0,n.useRef)(null),o=Pr();return(0,n.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[t]),n.createElement(f.Z,{variant:"body1",component:"div"},n.createElement(Or.Z,{className:o.root},t.map((function(e){return n.createElement(Tr.Z,{key:e[0].fullmove,className:o.fullmove},n.createElement("span",{className:o.count},e[0].fullmove,"."),e.map((function(e){var t=e.halfmove,r=e.san;return n.createElement("span",{key:t,className:o.halfmove},r)})))})),n.createElement("li",{ref:r,role:"presentation"})))},Ar=(0,n.memo)(jr),Nr=r(964),Ir=r(2644);const zr=(0,m.Z)((function(e){return(0,d.Z)({title:{padding:e.spacing(3,4,2)},content:{padding:e.spacing(2,4,4)},formControl:{width:100,textAlign:"right"},select:{textAlign:"left",textTransform:"capitalize"},selectOption:{textTransform:"capitalize"}})}));var Lr,Rr,Fr=function(e){var t=e.isOpen,r=e.settings,o=e.updateSettings,a=e.toggleSettings,i=zr();return n.createElement(or.Z,{open:t,onClose:function(){return a(!1)},"aria-labelledby":"chessSettingsDialogTitle","aria-describedby":"chessSettingsDialogDescription"},n.createElement(ir.Z,{disableTypography:!0,id:"chessSettingsDialogTitle",className:i.title,"aria-level":1},n.createElement(f.Z,{variant:"h4",component:"div"},"Settings")),n.createElement(ar.Z,{className:i.content},n.createElement(pr.Z,{display:"flex",alignItems:"center",mb:1},n.createElement(pr.Z,{flexGrow:1},n.createElement(f.Z,{variant:"body1",color:"textSecondary"},"Highlight moves")),n.createElement(pr.Z,{flexShrink:0,className:i.formControl},n.createElement(Z.Z,{checked:r.highlightMoves,color:"primary",onChange:function(e,t){return o({highlightMoves:t})}}))),n.createElement(pr.Z,{display:"flex",alignItems:"center",mb:1},n.createElement(pr.Z,{flexGrow:1},n.createElement(f.Z,{variant:"body1",color:"textSecondary"},"Show legal moves")),n.createElement(pr.Z,{flexShrink:0,className:i.formControl},n.createElement(Z.Z,{checked:r.showLegalMoves,color:"primary",onChange:function(e,t){return o({showLegalMoves:t})}}))),n.createElement(pr.Z,{display:"flex",alignItems:"center",mb:1},n.createElement(pr.Z,{flexGrow:1},n.createElement(f.Z,{variant:"body1",color:"textSecondary"},"Auto promote to Queen")),n.createElement(pr.Z,{flexShrink:0,className:i.formControl},n.createElement(Z.Z,{checked:r.autoPromoteToQueen,color:"primary",onChange:function(e,t){return o({autoPromoteToQueen:t})}}))),n.createElement(pr.Z,{display:"flex",alignItems:"center",mb:0},n.createElement(pr.Z,{flexGrow:1},n.createElement(f.Z,{variant:"body1",color:"textSecondary"},"Board color")),n.createElement(pr.Z,{flexShrink:0,className:i.formControl},n.createElement(Ir.Z,{value:r.boardColor,fullWidth:!0,className:i.select,onChange:function(e){return o({boardColor:e.target.value})}},["arctic","loyal","golden"].map((function(e){return n.createElement(Nr.Z,{key:e,value:e,className:i.selectOption},e)})))))))};function Dr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e){e.FlipColorMode="flipColorMode",e.UpdateGameSettings="updateGameSettings"}(Rr||(Rr={}));var Gr=(0,Y.oM)({name:"preferences",initialState:{colorMode:j.ColorMode.Light,highlightMoves:!0,showLegalMoves:!0,autoPromoteToQueen:!1,boardColor:"arctic"},reducers:(Lr={},Dr(Lr,Rr.FlipColorMode,(function(e){e.colorMode=e.colorMode===j.ColorMode.Dark?j.ColorMode.Light:j.ColorMode.Dark})),Dr(Lr,Rr.UpdateGameSettings,(function(e,t){Object.assign(e,t.payload)})),Lr)}),qr=Gr.actions,Br=Gr.reducer,Ur=qr.flipColorMode,Wr=qr.updateGameSettings;function _r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $r(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Hr=function(){var e=(0,n.useContext)(gt),t=(0,a.v9)((function(e){return{gameOver:e.chess.gameOver,moves:e.chess.moves,playerColor:e.chess.playerColor,settings:e.preferences,turn:e.chess.turn}})),r=t.settings,o=t.gameOver,i=t.moves,l=t.playerColor,c=t.turn,u=(0,a.I0)(),s=_r((0,n.useState)(!1),2),f=s[0],m=s[1],d=c===l,p=(0,n.useMemo)((function(){return wr()(i,2)}),[i]),g=(0,n.useMemo)((function(){return!!l&&!o&&i.length>0}),[o,l,i]),v=(0,n.useMemo)((function(){return!!l&&!o&&i.length>("w"===l?1:0)&&c===l}),[o,i,l,c]),h=(0,n.useCallback)((function(){return u(Ge())}),[u]),y=(0,n.useCallback)((function(){var t=d?2:1;st()(t,(function(){return e.undo()})),u(je({length:t,board:e.board()}))}),[u,d,e]),b=(0,n.useCallback)((function(){return u(Ie())}),[u]),E=function(e){m((function(t){return"boolean"==typeof e?e:!t}))},w=(0,n.useCallback)((function(e){return u(Wr(e))}),[u]);return n.createElement(n.Fragment,null,n.createElement(Mr,{canResign:g,canTakeBack:v,flipBoard:h,resign:b,takeBack:y,toggleSettings:E}),n.createElement(Ar,{moveList:p}),n.createElement(Fr,{isOpen:f,settings:r,toggleSettings:E,updateSettings:w}))};const Qr=(0,n.memo)(Hr),Kr=(0,m.Z)({root:{height:"100%",paddingTop:20,paddingBottom:20,boxSizing:"border-box",display:"flex",flexFlow:"row nowrap",justifyContent:"center"},main:{display:"flex",flexFlow:"column"},sidebar:{width:320,marginLeft:30,flex:"0 0 auto"}});var Vr=function(){var e=Kr();return n.createElement(F.Z,{maxWidth:!1,className:e.root},n.createElement("div",{className:e.main},n.createElement(br,null)),n.createElement("div",{className:e.sidebar},n.createElement(Qr,null)))};const Yr=function(){return n.createElement(R.rs,null,n.createElement(R.AW,{exact:!0,path:"/",component:_e}),n.createElement(R.AW,{path:"/play",component:Vr}),n.createElement(R.AW,{component:$e}))};const Jr=function(){var e=(0,a.v9)((function(e){return e.preferences.colorMode})),t=(0,a.I0)(),r=(0,n.useMemo)((function(){return(0,ft.getTheme)(e)}),[e]);return n.createElement(s.Z,{theme:r},n.createElement(l.W,{backend:c.z,options:Xe},n.createElement(u.ZP,null),n.createElement(L,{colorMode:e,toggleColorMode:function(){return t(Ur())}},n.createElement(S,null,n.createElement(Yr,null)))))};var Xr=r(3493),en=r.n(Xr),tn=(0,r(4890).UY)({chess:Ce,preferences:Br}),rn=(0,Y.xC)({reducer:tn,preloadedState:function(){try{var e=localStorage.getItem("appState");if(null===e)return;return JSON.parse(e)}catch(e){return}}(),devTools:!1});rn.subscribe(en()((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("appState",t)}catch(e){return!1}}({preferences:rn.getState().preferences})}),1e3));const nn=rn;(0,o.render)(n.createElement(a.zt,{store:nn},n.createElement(i.VK,null,n.createElement(Jr,null))),document.querySelector("#app"))},7570:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});var n={lightSquare:"#fff",darkSquare:"#97b2ce",highlight:"#ffff32",hover:"#fff"}},6086:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});var n={lightSquare:"#f5e1a2",darkSquare:"#6b6c6e",highlight:"#ffff32",hover:"#fff"}},4849:(e,t,r)=>{"use strict";r.d(t,{M:()=>l,A:()=>c});var n=r(7570),o=r(6086),a=r(7797),i=r(5126);r.o(i,"getTheme")&&r.d(t,{getTheme:function(){return i.getTheme}});var l=n.k,c=function(e){switch(e){case"arctic":return n.k;case"golden":return o.R;case"loyal":return a.a;default:throw new Error("Unexpected chess board theme variant: ".concat(e,"."))}}},7797:(e,t,r)=>{"use strict";r.d(t,{a:()=>n});var n={lightSquare:"#dcd0c2",darkSquare:"#376c57",highlight:"#ffff32",hover:"#fff"}},5126:()=>{},2833:(e,t,r)=>{"use strict";r.d(t,{g:()=>s});var n=r(6913),o=r.n(n),a=r(8129),i=r(4130),l=(r(9600),{typography:{htmlFontSize:16,fontFamily:["Roboto","-apple-system","BlinkMacSystemFont","Helvetica","Arial","sans-serif"].join(","),fontSize:16,h1:{fontSize:"3rem",fontWeight:400},h2:{fontSize:"2.2rem",fontWeight:400},h3:{fontSize:"1.8rem",fontWeight:400},h4:{fontSize:"1.6rem",fontWeight:400},h5:{fontSize:"1.4rem",fontWeight:400},h6:{fontSize:"1.2rem",fontWeight:400}},shape:{borderRadius:0},overrides:{MuiCssBaseline:{"@global":{"html, body, #app":{height:"100%",overflow:"hidden"},a:{color:"inherit"},"::selection":{color:"#fff",backgroundColor:"#303f9f"}}},MuiButton:{root:{transition:"none"}},MuiInputLabel:{root:{marginBottom:5,fontSize:"1.2rem"}},MuiTooltip:{tooltip:{fontSize:"1em"}}},chessSquare:{light:"#fff",dark:"#97b2ce",highlight:"#ffff32",hover:"#fff"}}),c={palette:{type:"dark",primary:{main:"#3f4fa6"},secondary:{main:"#ebca47"},background:{default:"#282C34",paper:"#1c2025"},text:{primary:"#ddd",secondary:"#aaa",disabled:"#999",hint:"#999"}},overrides:{MuiFormLabel:{root:{"&$focused":{color:"#aaa"}}}}},u={palette:{type:"light",primary:{main:r(8768).Z[500],contrastText:"#fff"},secondary:{main:"#3f4fa6"},background:{default:"#edeff6",paper:"#fafafc"}}},s=function(e){return(0,a.Z)(o()({},l,e===i.ColorMode.Dark?c:u))}},3663:(e,t,r)=>{"use strict";r.d(t,{defaultChessBoardTheme:()=>n.M,getChessBoardTheme:()=>n.A,getTheme:()=>o.g});var n=r(4849);r.o(n,"getTheme")&&r.d(t,{getTheme:function(){return n.getTheme}});var o=r(2833)},6750:()=>{},727:(e,t,r)=>{"use strict"},5699:(e,t,r)=>{"use strict";r.d(t,{m:()=>n});var n={Checkmate:0,Resignation:1,Timeout:2,Stalemate:3,NotEnoughMaterial:4,Repetition:5}},8563:()=>{},501:()=>{},4582:()=>{},2664:()=>{},3360:()=>{},4130:(e,t,r)=>{"use strict";r.d(t,{ChessGameOverType:()=>o.m,ColorMode:()=>s.U});var n=r(6750);r.o(n,"ChessGameOverType")&&r.d(t,{ChessGameOverType:function(){return n.ChessGameOverType}}),r.o(n,"ColorMode")&&r.d(t,{ColorMode:function(){return n.ColorMode}});r(727);var o=r(5699),a=r(8563);r.o(a,"ColorMode")&&r.d(t,{ColorMode:function(){return a.ColorMode}});var i=r(501);r.o(i,"ColorMode")&&r.d(t,{ColorMode:function(){return i.ColorMode}});var l=r(4582);r.o(l,"ColorMode")&&r.d(t,{ColorMode:function(){return l.ColorMode}});var c=r(2664);r.o(c,"ColorMode")&&r.d(t,{ColorMode:function(){return c.ColorMode}});var u=r(3360);r.o(u,"ColorMode")&&r.d(t,{ColorMode:function(){return u.ColorMode}});var s=r(3008)},3008:(e,t,r)=>{"use strict";r.d(t,{U:()=>n});var n={Dark:0,Light:1}}},t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n](o,o.exports,r),o.loaded=!0,o.exports}r.m=e,r.x=e=>{},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={179:0},t=[[4792,216]],n=e=>{},o=(o,a)=>{for(var i,l,[c,u,s,f]=a,m=0,d=[];m<c.length;m++)l=c[m],r.o(e,l)&&e[l]&&d.push(e[l][0]),e[l]=0;for(i in u)r.o(u,i)&&(r.m[i]=u[i]);for(s&&s(r),o&&o(a);d.length;)d.shift()();return f&&t.push.apply(t,f),n()},a=self.webpackChunkchess_player=self.webpackChunkchess_player||[];function i(){for(var n,o=0;o<t.length;o++){for(var a=t[o],i=!0,l=1;l<a.length;l++){var c=a[l];0!==e[c]&&(i=!1)}i&&(t.splice(o--,1),n=r(r.s=a[0]))}return 0===t.length&&(r.x(),r.x=e=>{}),n}a.forEach(o.bind(null,0)),a.push=o.bind(null,a.push.bind(a));var l=r.x;r.x=()=>(r.x=l||(e=>{}),(n=i)())})(),r.x()})();